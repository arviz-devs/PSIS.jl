var documenterSearchIndex = {"docs":
[{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [PSIS]\nPrivate = false","category":"page"},{"location":"api/#PSIS.psis!-Tuple{AbstractVector{T} where T, Any}","page":"API","title":"PSIS.psis!","text":"psis!(args, r_eff; kwargs...)\n\nIn-place compute Pareto smoothed importance sampling (PSIS) log weights.\n\nSee psis for an out-of-place version and for description of arguments and return values.\n\n\n\n\n\n","category":"method"},{"location":"api/#PSIS.psis-Tuple{Any, Any}","page":"API","title":"PSIS.psis","text":"psis(log_ratios, r_eff; kwargs...) -> (log_weights, k)\n\nCompute Pareto smoothed importance sampling (PSIS) log weights [VehtariSimpson2021].\n\nSee psis! for a version that smoothes the ratios in-place.\n\nArguments\n\nlog_ratios: an array of logarithms of importance ratios, with one of the following sizes:\n(ndraws,): a vector of draws for a single parameter from a single chain\n(nparams, ndraws): a matrix of draws for a multiple parameter from a single chain\n(nparams, ndraws, nchains): an array of draws for multiple parameters from multiple chains, e.g. as might be generated with Markov chain Monte Carlo.\nr_eff: the ratio of effective sample size of log_ratios and the actual sample size, used to account for autocorrelation, e.g. due to Markov chain Monte Carlo. If the ratios are known to be uncorrelated, then provide r_eff=ones(nparams).\n\nKeywords\n\nsorted=issorted(vec(log_ratios)): whether log_ratios are already sorted. Only accepted if nparams==1.\nnormalize=false: whether to normalize the log weights so that the resulting weights for a given parameter sum to one.\nimproved=false: If true, use the adaptive empirical prior of [Zhang2010]. If false, use the simpler prior of [ZhangStephens2009], which is also used in [VehtariSimpson2021].\n\nReturns\n\nlog_weights: an array of smoothed log weights of the same size as log_ratios\nk: for each parameter, the estimated shape parameter k of the generalized Pareto distribution, which is useful for diagnosing the distribution of importance ratios. See details below.\n\nDiagnostic\n\nThe shape parameter k of the generalized Pareto distribution can be used to diagnose reliability and convergence of estimates using the importance weights [VehtariSimpson2021]:\n\nif k  frac13, importance sampling is stable, and importance sampling (IS) and PSIS both are reliable.\nif k  frac12, then the importance ratio distributon has finite variance, and the central limit theorem holds. As k approaches the upper bound, IS becomes less reliable, while PSIS still works well but with a higher RMSE.\nif frac12  k  07, then the variance is infinite, and IS can behave quite poorly. However, PSIS works well in this regime.\nif 07  k  1, then it quickly becomes impractical to collect enough importance weights to reliably compute estimates, and importance sampling is not recommended.\nif k  1, then neither the variance nor the mean of the raw importance ratios exists. The convergence rate is close to zero, and bias can be large with practical sample sizes.\n\nA warning is raised if k  07.\n\n[VehtariSimpson2021]: Vehtari A, Simpson D, Gelman A, Yao Y, Gabry J. (2021). Pareto smoothed importance sampling. arXiv:1507.02646v7 [stat.CO]\n\n[ZhangStephens2009]: Jin Zhang & Michael A. Stephens (2009) A New and Efficient Estimation Method for the Generalized Pareto Distribution, Technometrics, 51:3, 316-325, DOI: 10.1198/tech.2009.08017\n\n[Zhang2010]: Jin Zhang (2010) Improving on Estimation for the Generalized Pareto Distribution, Technometrics, 52:3, 335-339, DOI: 10.1198/TECH.2010.09206\n\n\n\n\n\n","category":"method"},{"location":"internal/#Internal","page":"Internal","title":"Internal","text":"","category":"section"},{"location":"internal/","page":"Internal","title":"Internal","text":"Modules = [PSIS]\nPublic = false","category":"page"},{"location":"internal/#PSIS.GeneralizedParetoKnownMu","page":"Internal","title":"PSIS.GeneralizedParetoKnownMu","text":"GeneralizedParetoKnownMu(μ)\n\nRepresents a GeneralizedPareto where mu is known.\n\n\n\n\n\n","category":"type"},{"location":"internal/#PSIS.GeneralizedParetoKnownMuTheta","page":"Internal","title":"PSIS.GeneralizedParetoKnownMuTheta","text":"GeneralizedParetoKnownMuTheta(μ, θ)\n\nRepresents a GeneralizedPareto where mu and theta=fracxisigma are known.\n\n\n\n\n\n","category":"type"},{"location":"internal/#StatsBase.fit-Tuple{PSIS.GeneralizedParetoKnownMu, AbstractArray}","page":"Internal","title":"StatsBase.fit","text":"fit(g::GeneralizedParetoKnownMu, x; kwargs...)\n\nFit a GeneralizedPareto with known location μ to the data x.\n\nThe fit is performed using the Empirical Bayes method of [ZhangStephens2009][Zhang2010].\n\nKeywords\n\nsorted::Bool=issorted(x): If true, x is assumed to be sorted. If false, a sorted copy of x is made.\nimproved::Bool=true: If true, use the adaptive empirical prior of [Zhang2010]. If false, use the simpler prior of [ZhangStephens2009].\nmin_points::Int=30: The minimum number of quadrature points to use when estimating the posterior mean of theta = fracxisigma.\n\n[ZhangStephens2009]: Jin Zhang & Michael A. Stephens (2009) A New and Efficient Estimation Method for the Generalized Pareto Distribution, Technometrics, 51:3, 316-325, DOI: 10.1198/tech.2009.08017\n\n[Zhang2010]: Jin Zhang (2010) Improving on Estimation for the Generalized Pareto Distribution, Technometrics, 52:3, 335-339, DOI: 10.1198/TECH.2010.09206\n\n\n\n\n\n","category":"method"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = PSIS","category":"page"},{"location":"#PSIS","page":"Home","title":"PSIS","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"PSIS.jl implements the Pareto smoothed importance sampling (PSIS) algorithm from [VehtariSimpson2021].","category":"page"},{"location":"","page":"Home","title":"Home","text":"Given a set of importance weights used in some estimator, PSIS both improves the reliability of the estimates by smoothing the importance weights and acts as a diagnostic of the reliability of the estimates.","category":"page"},{"location":"","page":"Home","title":"Home","text":"See psis for details.","category":"page"},{"location":"","page":"Home","title":"Home","text":"[VehtariSimpson2021]: Vehtari A, Simpson D, Gelman A, Yao Y, Gabry J. (2021). Pareto smoothed importance sampling. arXiv:1507.02646v7 [stat.CO]","category":"page"}]
}
